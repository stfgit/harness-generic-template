template:
  name: source code scan
  identifier: source_code_scan
  versionLabel: v0.1
  type: Stage
  tags:
    secops: ""
    code scan: ""
  icon: data:image/png;base64,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
  spec:
    type: SecurityTests
    spec:
      cloneCodebase: true
      infrastructure:
        type: KubernetesDirect
        spec:
          connectorRef: account.k8sdocacloud
          namespace: <+input>.default(harness-ci)
          automountServiceAccountToken: true
          nodeSelector: {}
          os: Linux
      execution:
        steps:
          - parallel:
              - step:
                  type: Semgrep
                  name: semgrep
                  identifier: semgrep
                  spec:
                    mode: orchestration
                    config: default
                    target:
                      type: repository
                      detection: auto
                    advanced:
                      log:
                        level: info
                      fail_on_severity: high
              - step:
                  type: Owasp
                  name: owasp
                  identifier: owasp
                  spec:
                    mode: orchestration
                    config: default
                    target:
                      type: repository
                      detection: auto
                    advanced:
                      log:
                        level: info
                      fail_on_severity: high
              - step:
                  type: AquaTrivy
                  name: aquatrivy
                  identifier: aquatrivy
                  spec:
                    mode: orchestration
                    config: fs
                    target:
                      type: repository
                      detection: auto
                    advanced:
                      log:
                        level: info
                      fail_on_severity: high
                    privileged: true
